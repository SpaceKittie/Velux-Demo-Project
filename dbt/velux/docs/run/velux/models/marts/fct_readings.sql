-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into VELUX_DEV.MARTS.fct_readings as DBT_INTERNAL_DEST
        using VELUX_DEV.MARTS.fct_readings__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.reading_id = DBT_INTERNAL_DEST.reading_id))

    
    when matched then update set
        "READING_ID" = DBT_INTERNAL_SOURCE."READING_ID","TIME_ID" = DBT_INTERNAL_SOURCE."TIME_ID","LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","SENSOR_ID" = DBT_INTERNAL_SOURCE."SENSOR_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TIMESTAMP" = DBT_INTERNAL_SOURCE."EVENT_TIMESTAMP","DEVICE_ID" = DBT_INTERNAL_SOURCE."DEVICE_ID","SENSOR_VALUE" = DBT_INTERNAL_SOURCE."SENSOR_VALUE","OUTDOOR_TEMPERATURE_CELSIUS" = DBT_INTERNAL_SOURCE."OUTDOOR_TEMPERATURE_CELSIUS","DEW_POINT_TEMPERATURE_CELSIUS" = DBT_INTERNAL_SOURCE."DEW_POINT_TEMPERATURE_CELSIUS","MEAN_SEA_LEVEL_PRESSURE_HPA" = DBT_INTERNAL_SOURCE."MEAN_SEA_LEVEL_PRESSURE_HPA","WIND_SPEED_MS" = DBT_INTERNAL_SOURCE."WIND_SPEED_MS","VISIBILITY_KM" = DBT_INTERNAL_SOURCE."VISIBILITY_KM","SOLAR_IRRADIANCE_W_M2" = DBT_INTERNAL_SOURCE."SOLAR_IRRADIANCE_W_M2","UV_INDEX" = DBT_INTERNAL_SOURCE."UV_INDEX","SUNSHINE_DURATION_MINUTES" = DBT_INTERNAL_SOURCE."SUNSHINE_DURATION_MINUTES","PRECIPITATION_TYPE_DESCRIPTION" = DBT_INTERNAL_SOURCE."PRECIPITATION_TYPE_DESCRIPTION"
    

    when not matched then insert
        ("READING_ID", "TIME_ID", "LOCATION_ID", "SENSOR_ID", "EVENT_DATE", "EVENT_TIMESTAMP", "DEVICE_ID", "SENSOR_VALUE", "OUTDOOR_TEMPERATURE_CELSIUS", "DEW_POINT_TEMPERATURE_CELSIUS", "MEAN_SEA_LEVEL_PRESSURE_HPA", "WIND_SPEED_MS", "VISIBILITY_KM", "SOLAR_IRRADIANCE_W_M2", "UV_INDEX", "SUNSHINE_DURATION_MINUTES", "PRECIPITATION_TYPE_DESCRIPTION")
    values
        ("READING_ID", "TIME_ID", "LOCATION_ID", "SENSOR_ID", "EVENT_DATE", "EVENT_TIMESTAMP", "DEVICE_ID", "SENSOR_VALUE", "OUTDOOR_TEMPERATURE_CELSIUS", "DEW_POINT_TEMPERATURE_CELSIUS", "MEAN_SEA_LEVEL_PRESSURE_HPA", "WIND_SPEED_MS", "VISIBILITY_KM", "SOLAR_IRRADIANCE_W_M2", "UV_INDEX", "SUNSHINE_DURATION_MINUTES", "PRECIPITATION_TYPE_DESCRIPTION")

;
    commit;